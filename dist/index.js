"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(){this._consumers=[],this._producers=[]}return n.prototype.consume=function(n){var r=this,t=setImmediate((function(){return r._update()}));return this._consumers.push(n),function(){clearImmediate(t),r._consumers=r._consumers.filter((function(r){return r!==n}))}},n.prototype.produce=function(n){var r=this,t=setImmediate((function(){return r._update()}));return this._producers.push(n),function(){clearImmediate(t),r._producers=r._producers.filter((function(r){return r!==n}))}},n.prototype._update=function(){for(;;){var n=this._producers.shift();if(!n)break;var r=this._consumers.shift();if(!r){this._producers.unshift(n);break}n(r)}},n}();exports.chan=function(){return new n},exports.put=function(n,r){return new Promise((function(t){return n.produce((function(n){n(r),t(r)}))}))},exports.putFirst=function(n){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return new Promise((function(t){var e=r.map((function(r){return r.produce((function(u){e.forEach((function(n){return n()})),u(n),t({channel:r,value:n})}))}))}))},exports.selected=function(n,r){return n.channel===r},exports.take=function(n){return new Promise((function(r){return n.consume(r)}))},exports.takeFirst=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new Promise((function(r){var t=n.map((function(n){return n.consume((function(e){t.forEach((function(n){return n()})),r({channel:n,value:e})}))}))}))};
